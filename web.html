<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TORCH | OS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;500;800&family=Rajdhani:wght@500;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --c-accent: #ff9d00;
            --c-accent-dim: rgba(255, 157, 0, 0.1);
            --c-bg: #020202;
            --c-glass: rgba(10, 10, 10, 0.7);
            --c-border: rgba(255, 255, 255, 0.1);
            --font-mono: 'JetBrains Mono', monospace;
            --font-disp: 'Rajdhani', sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100dvh;
            background-color: var(--c-bg);
            color: #e0e0e0;
            font-family: var(--font-mono);
            overflow: hidden;
            user-select: none;
        }

        .layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }

        #grid-layer {
            background-image:
                linear-gradient(rgba(30, 30, 30, 0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(30, 30, 30, 0.3) 1px, transparent 1px);
            background-size: clamp(20px, 4vw, 40px) clamp(20px, 4vw, 40px);
            opacity: 0.2;
            z-index: 0;
        }

        #particle-canvas { z-index: 1; }

        #light-mask {
            background: radial-gradient(
                circle 600px at var(--x) var(--y),
                transparent 0%,
                rgba(2, 2, 2, 0.85) 50%,
                rgba(2, 2, 2, 1) 100%
            );
            z-index: 2;
        }

        #ui-layer {
            z-index: 10;
            pointer-events: auto;
            position: relative;

            /* SHARPNESS FIX: Use zoom instead of transform: scale */
            width: 100%;
            height: 100%;
            zoom: 0.9;

            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: clamp(10px, 2vw, 20px);
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            width: 100%;
            gap: 15px;
            flex-wrap: wrap;
            flex-shrink: 0;
        }

        .widget {
            background: var(--c-glass);
            border: 1px solid var(--c-border);
            backdrop-filter: blur(12px);
            padding: 15px;
            border-radius: 4px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }

        .widget:hover {
            border-color: rgba(255, 157, 0, 0.3);
            box-shadow: 0 0 15px rgba(255, 157, 0, 0.1);
        }

        .w-header {
            font-family: var(--font-disp);
            font-weight: 700;
            font-size: 0.8rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .id-card {
            width: 300px;
            border-left: 2px solid var(--c-accent);
            flex-shrink: 0;
        }
        .id-main { display: flex; align-items: center; gap: 15px; }
        .id-avatar {
            width: 40px; height: 40px;
            background: rgba(255, 157, 0, 0.1);
            display: flex; align-items: center; justify-content: center;
            border: 1px solid var(--c-accent);
        }
        .id-info h1 { font-family: var(--font-disp); font-size: 1.5rem; line-height: 1; color: #fff; font-weight: 700; }
        .id-info p { font-size: 0.75rem; color: var(--c-accent); }

        .sys-card {
            width: 250px;
            text-align: right;
            border-right: 2px solid #333;
            flex-shrink: 1;
        }
        .stat-row { font-size: 0.75rem; margin-bottom: 4px; display: flex; justify-content: space-between; gap: 20px; }
        .stat-label { color: #555; }
        .stat-val { color: #aaa; }

        #stage {
            flex-grow: 1;
            position: relative;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none;
            min-height: 0;
        }

        .window {
            width: 90%;
            max-width: 1000px;
            height: 85%;
            max-height: 800px;
            background: rgba(5, 5, 5, 0.9);
            border: 1px solid var(--c-border);
            border-top: 2px solid var(--c-accent);
            display: none;
            flex-direction: column;
            pointer-events: auto;
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
        }
        .window.active { display: flex; }

        .win-head {
            background: rgba(255,255,255,0.03);
            padding: 10px 15px;
            font-size: 0.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--c-border);
            color: #888;
            flex-shrink: 0;
        }

        .res-nav {
            display: flex;
            border-bottom: 1px solid var(--c-border);
            background: rgba(0,0,0,0.3);
            overflow-x: auto;
            scrollbar-width: none;
            flex-shrink: 0;
        }
        .res-nav button {
            background: transparent;
            border: none;
            color: #666;
            padding: 10px 15px;
            font-family: var(--font-disp);
            font-weight: 700;
            font-size: 0.8rem;
            cursor: pointer;
            transition: 0.2s;
            border-bottom: 2px solid transparent;
            white-space: nowrap;
        }
        .res-nav button:hover { color: #ccc; background: rgba(255,255,255,0.02); }
        .res-nav button.active { color: var(--c-accent); border-bottom-color: var(--c-accent); }

        .win-body {
            flex-grow: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 0;
            position: relative;
            scrollbar-width: thin;
            scrollbar-color: #333 transparent;
            -webkit-overflow-scrolling: touch;
        }

        .win-body::-webkit-scrollbar { width: 6px; }
        .win-body::-webkit-scrollbar-track { background: transparent; }
        .win-body::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
        .win-body::-webkit-scrollbar-thumb:hover { background: var(--c-accent); }

        .dock-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 0;
            pointer-events: auto;
            width: 100%;
            z-index: 20;
            flex-shrink: 0;
        }

        .dock {
            display: flex;
            gap: 10px;
            background: rgba(20, 20, 20, 0.85);
            border: 1px solid var(--c-border);
            padding: 10px;
            border-radius: 12px;
            backdrop-filter: blur(15px);
            max-width: 100%;
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }
        .dock::-webkit-scrollbar { display: none; }

        .dock-btn {
            background: transparent;
            border: 1px solid transparent;
            color: #888;
            padding: 10px 20px;
            font-family: var(--font-disp);
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            position: relative;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .dock-btn:hover {
            color: #fff;
            background: rgba(255,255,255,0.05);
            transform: translateY(-2px);
        }

        .dock-btn.active {
            color: var(--c-accent);
            background: var(--c-accent-dim);
            border-color: rgba(255, 157, 0, 0.3);
            box-shadow: 0 0 15px rgba(255, 157, 0, 0.1);
        }

        .dock-btn.active::after {
            content: ''; position: absolute; bottom: -6px; left: 50%; transform: translateX(-50%);
            width: 4px; height: 4px; background: var(--c-accent); border-radius: 50%;
        }

        #term-output { padding: 20px; font-size: clamp(0.8rem, 2vw, 1rem); color: #ccc; height: 100%; overflow-y: auto; }
        .ln { margin-bottom: 4px; word-wrap: break-word; line-height: 1.5; }
        .pr { color: var(--c-accent); margin-right: 8px; display: inline-block; }
        .inp { background: transparent; border: none; color: #fff; width: 60%; outline: none; font-family: inherit; font-size: inherit; }

        .id-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 20px;
        }

        .social-link {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--c-border);
            padding: 12px 15px;
            color: #ccc;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 0.9rem;
            width: 100%;
            border-radius: 4px;
        }
        .social-link:hover {
            background: var(--c-accent-dim);
            border-color: var(--c-accent);
            transform: translateX(2px);
            cursor: pointer;
        }

        .res-section { display: none; }
        .res-section.active { display: block; animation: fadeIn 0.3s ease; }

        .res-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
        }
        .res-card {
            display: block;
            text-decoration: none;
            background: rgba(255,255,255,0.02);
            border: 1px solid var(--c-border);
            padding: 15px;
            transition: 0.2s;
            height: 100%;
            overflow: hidden;
        }
        .res-card:hover {
            background: var(--c-accent-dim);
            border-color: var(--c-accent);
            transform: translateY(-2px);
        }
        .res-card h4 { color: #fff; font-weight: bold; margin-bottom: 2px; font-size: 0.95rem; }
        .res-card p { color: #666; font-size: 0.75rem; line-height: 1.3; }
        .tag { color: var(--c-accent); font-size: 0.65rem; font-weight: bold; letter-spacing: 1px; display: block; margin-bottom: 5px; }

        #local-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
        }
        .data-card {
            background: rgba(255,255,255,0.02);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 15px;
        }
        .data-val { font-size: 1rem; color: #fff; word-break: break-all; }

        @media (max-width: 1024px) {
            .window { width: 95%; height: 85%; }
            .id-card { width: auto; flex-grow: 1; }
        }

        @media (max-width: 768px) {
            body, html {
                overflow-y: auto !important;
                height: auto !important;
                -webkit-overflow-scrolling: touch;
            }

            #ui-layer {
                display: block;
                width: 100%;
                height: auto !important;
                zoom: 1; /* Reset zoom on mobile to avoid layout bugs */
                min-height: 100vh;
                padding-bottom: 90px;
            }

            .top-bar { margin-bottom: 20px; }
            .sys-card { display: none; }

            .id-card {
                width: 100%;
                border-left: none;
                border-bottom: 1px solid var(--c-accent);
                background: rgba(10,10,10,0.9);
            }

            #stage {
                display: block;
                height: auto !important;
                margin: 0;
            }

            .window {
                width: 100%;
                height: auto !important;
                min-height: 400px;
                border: none;
                border-top: 1px solid var(--c-accent);
                background: rgba(5,5,5,0.95);
                margin-bottom: 20px;
                display: none;
            }
            .window.active { display: flex; }

            .win-body {
                overflow: visible !important;
                height: auto !important;
                flex-grow: 0;
            }

            .dock-container {
                position: fixed;
                bottom: 0;
                left: 0;
                background: linear-gradient(to top, #020202 85%, transparent);
                padding: 15px 10px 20px 10px;
                z-index: 999;
            }
            .dock {
                width: 100%;
                border-radius: 0;
                border: none;
                background: rgba(20,20,20,0.95);
                justify-content: flex-start;
                padding: 10px;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
            }
            .dock-btn { padding: 8px 16px; font-size: 0.9rem; }

            .res-grid { grid-template-columns: 1fr; gap: 10px; padding: 15px; }
            .res-card {
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 15px;
                min-height: 60px;
            }
            .res-card-content { flex: 1; min-width: 0; text-align: right; }
            .res-card h4 { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
            .res-card .tag { margin-bottom: 0; flex-shrink: 0; }
        }

        @media (max-width: 400px) {
            .id-info h1 { font-size: 1.2rem; }
            .dock-btn { padding: 8px 12px; font-size: 0.8rem; }
        }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes torch-flicker { 0% { opacity: 0.8; transform: translateY(0); } 100% { opacity: 1; transform: translateY(-1px); } }
        .torch-anim { animation: torch-flicker 0.1s infinite alternate; }

    </style>
</head>
<body>

    <div id="grid-layer" class="layer"></div>
    <canvas id="particle-canvas" class="layer"></canvas>
    <div id="light-mask" class="layer" style="--x: 50%; --y: 50%;"></div>

    <div id="ui-layer">

        <div class="top-bar">
            <div class="widget id-card">
                <div class="w-header">
                    <span>ACTIVE_SESSION</span>
                    <span style="width:8px; height:8px; background:#0f0; border-radius:50%; box-shadow:0 0 5px #0f0;"></span>
                </div>
                <div class="id-main">
                    <div class="id-avatar">
                        <svg width="24" height="24" viewBox="0 0 10 20" style="filter: drop-shadow(0 0 5px #ffaa00);">
                            <rect x="4" y="9" width="2" height="10" fill="#5d4037"/>
                            <rect x="3" y="6" width="4" height="3" fill="#3e2723"/>
                            <rect x="4" y="4" width="2" height="2" fill="#ff5722"/>
                            <rect x="4" y="2" width="2" height="2" fill="#ffeb3b" class="torch-anim"/>
                        </svg>
                    </div>
                    <div class="id-info">
                        <h1>TORCH</h1>
                        <p>JORDANSEC // WEB_OPS</p>
                    </div>
                </div>
            </div>

            <div class="widget sys-card">
                <div class="w-header">LOCAL_ENV</div>
                <div id="sys-data"></div>
            </div>
        </div>

        <div id="stage">

            <div id="win-terminal" class="window active">
                <div class="win-head">
                    <span>TERMINAL</span>
                    <span>bash --login</span>
                </div>
                <div class="win-body">
                    <div id="term-output">
                        <div class="ln">TorchOS kernel loaded...</div>
                        <div class="ln">Welcome back. System integrity verified.</div>
                        <div class="ln"><br></div>
                    </div>
                </div>
            </div>

            <div id="win-resources" class="window">
                <div class="win-head">
                    <span>DATABASE</span>
                    <span>/usr/share/resources</span>
                </div>
                <div class="res-nav">
                    <button class="active" onclick="filterRes('all')">ALL</button>
                    <button onclick="filterRes('web')">WEB</button>
                    <button onclick="filterRes('ctf')">CTF</button>
                    <button onclick="filterRes('red')">RED</button>
                    <button onclick="filterRes('int')">INTEL</button>
                </div>
                <div class="win-body">

                    <div id="cat-web" class="res-section active">
                        <div class="res-grid">
                            <a href="https://portswigger.net/web-security" target="_blank" class="res-card"><span class="tag">ACADEMY</span><div class="res-card-content"><h4>PortSwigger</h4><p>The gold standard for web sec.</p></div></a>
                            <a href="https://owasp.org/www-project-juice-shop/" target="_blank" class="res-card"><span class="tag">LAB</span><div class="res-card-content"><h4>OWASP Juice Shop</h4><p>Modern broken web app.</p></div></a>
                            <a href="https://github.com/digininja/DVWA" target="_blank" class="res-card"><span class="tag">LAB</span><div class="res-card-content"><h4>DVWA</h4><p>Damn Vulnerable Web App.</p></div></a>
                            <a href="https://xss-game.appspot.com/" target="_blank" class="res-card"><span class="tag">GAME</span><div class="res-card-content"><h4>XSS Game</h4><p>Google's XSS practice.</p></div></a>
                            <a href="https://www.hacksplaining.com/" target="_blank" class="res-card"><span class="tag">LEARN</span><div class="res-card-content"><h4>Hacksplaining</h4><p>Vulns explained simply.</p></div></a>
                            <a href="https://pentesterlab.com/" target="_blank" class="res-card"><span class="tag">LEARN</span><div class="res-card-content"><h4>PentesterLab</h4><p>Web Pentest Bootcamps.</p></div></a>
                            <a href="https://google-gruyere.appspot.com/" target="_blank" class="res-card"><span class="tag">LAB</span><div class="res-card-content"><h4>Gruyere</h4><p>Cheesy web app exploit.</p></div></a>
                            <a href="https://owasp.org/www-project-top-ten/" target="_blank" class="res-card"><span class="tag">REF</span><div class="res-card-content"><h4>OWASP Top 10</h4><p>Critical web risks.</p></div></a>
                        </div>
                    </div>

                    <div id="cat-ctf" class="res-section active">
                        <div class="res-grid">
                            <a href="https://www.hackthebox.com/" target="_blank" class="res-card"><span class="tag">CTF</span><div class="res-card-content"><h4>Hack The Box</h4><p>Pentesting labs.</p></div></a>
                            <a href="https://tryhackme.com" target="_blank" class="res-card"><span class="tag">LEARN</span><div class="res-card-content"><h4>TryHackMe</h4><p>Guided cyber training.</p></div></a>
                            <a href="https://picoctf.org/" target="_blank" class="res-card"><span class="tag">BEGINNER</span><div class="res-card-content"><h4>PicoCTF</h4><p>Best starting point.</p></div></a>
                            <a href="https://overthewire.org/wargames/" target="_blank" class="res-card"><span class="tag">SSH</span><div class="res-card-content"><h4>OverTheWire</h4><p>Bandit & Wargames.</p></div></a>
                            <a href="https://cryptohack.org/" target="_blank" class="res-card"><span class="tag">CRYPTO</span><div class="res-card-content"><h4>CryptoHack</h4><p>Learn cryptography.</p></div></a>
                            <a href="https://ctftime.org/" target="_blank" class="res-card"><span class="tag">RANK</span><div class="res-card-content"><h4>CTFtime</h4><p>Global CTF Tracker.</p></div></a>
                        </div>
                    </div>

                    <div id="cat-red" class="res-section active">
                        <div class="res-grid">
                            <a href="https://www.revshells.com/" target="_blank" class="res-card"><span class="tag">SHELL</span><div class="res-card-content"><h4>RevShells</h4><p>Reverse shell generator.</p></div></a>
                            <a href="https://gtfobins.github.io/" target="_blank" class="res-card"><span class="tag">UNIX</span><div class="res-card-content"><h4>GTFOBins</h4><p>Unix binary bypass.</p></div></a>
                            <a href="https://lolbas-project.github.io/" target="_blank" class="res-card"><span class="tag">WIN</span><div class="res-card-content"><h4>LOLBAS</h4><p>Windows binary bypass.</p></div></a>
                            <a href="https://gchq.github.io/CyberChef/" target="_blank" class="res-card"><span class="tag">DATA</span><div class="res-card-content"><h4>CyberChef</h4><p>The Cyber Swiss Knife.</p></div></a>
                            <a href="https://crackstation.net/" target="_blank" class="res-card"><span class="tag">HASH</span><div class="res-card-content"><h4>CrackStation</h4><p>Hash cracker.</p></div></a>
                            <a href="https://github.com/danielmiessler/SecLists" target="_blank" class="res-card"><span class="tag">WORDLIST</span><div class="res-card-content"><h4>SecLists</h4><p>Wordlists repository.</p></div></a>
                            <a href="https://github.com/swisskyrepo/PayloadsAllTheThings" target="_blank" class="res-card"><span class="tag">CHEATS</span><div class="res-card-content"><h4>PayloadsAllTheThings</h4><p>Attack cheat sheets.</p></div></a>
                        </div>
                    </div>

                    <div id="cat-int" class="res-section active">
                        <div class="res-grid">
                            <a href="https://www.shodan.io/" target="_blank" class="res-card"><span class="tag">IOT</span><div class="res-card-content"><h4>Shodan</h4><p>IoT Search Engine.</p></div></a>
                            <a href="https://osintframework.com/" target="_blank" class="res-card"><span class="tag">MAP</span><div class="res-card-content"><h4>OSINT Framework</h4><p>Reconnaissance map.</p></div></a>
                            <a href="https://www.exploit-db.com/" target="_blank" class="res-card"><span class="tag">DB</span><div class="res-card-content"><h4>Exploit-DB</h4><p>CVE Archive.</p></div></a>
                            <a href="https://search.censys.io/" target="_blank" class="res-card"><span class="tag">SCAN</span><div class="res-card-content"><h4>Censys</h4><p>Internet asset search.</p></div></a>
                            <a href="https://dnsdumpster.com/" target="_blank" class="res-card"><span class="tag">DNS</span><div class="res-card-content"><h4>DNSDumpster</h4><p>DNS recon tool.</p></div></a>
                            <a href="https://web.archive.org/" target="_blank" class="res-card"><span class="tag">HIST</span><div class="res-card-content"><h4>Wayback Machine</h4><p>Internet history.</p></div></a>
                        </div>
                    </div>

                </div>
            </div>

            <div id="win-identity" class="window">
                <div class="win-head">
                    <span>PROFILE</span>
                    <span>user_info</span>
                </div>
                <div class="win-body">
                    <div class="id-content">
                        <svg width="120" height="120" viewBox="0 0 10 20" style="filter: drop-shadow(0 0 25px #ffaa00); margin-bottom: 25px;">
                            <rect x="4" y="9" width="2" height="10" fill="#5d4037"/>
                            <rect x="3" y="6" width="4" height="3" fill="#3e2723"/>
                            <rect x="4" y="4" width="2" height="2" fill="#ff5722"/>
                            <rect x="4" y="2" width="2" height="2" fill="#ffeb3b" class="torch-anim"/>
                        </svg>

                        <div style="letter-spacing: 4px; color:#888; border-top:1px solid #333; border-bottom:1px solid #333; padding:10px 0; margin-bottom: 30px; width: 100%; max-width: 300px;">WEB EXPLOITATION</div>

                        <div style="display:flex; flex-direction:column; gap:10px; width: 100%; max-width: 300px;">

                            <a href="https://github.com/Torch4084" target="_blank" class="social-link">
                                <span style="font-weight:bold;">GITHUB</span>
                                <span style="color:var(--c-accent); font-family:var(--font-mono);">@Torch4084</span>
                            </a>

                            <div class="social-link">
                                <span style="font-weight:bold;">DISCORD</span>
                                <span style="color:var(--c-accent); font-family:var(--font-mono);">Torch4084</span>
                            </div>
                        </div>

                        <div style="display:flex; gap:30px; margin-top:30px;">
                            <div><div style="font-size:0.7rem; color:#666">ID</div><div style="color:var(--c-accent)">0x312</div></div>
                            <div><div style="font-size:0.7rem; color:#666">TEAM</div><div style="color:var(--c-accent)">JordanSec</div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="win-local" class="window">
                <div class="win-head">
                    <span>RECONNAISSANCE</span>
                    <span>local_env</span>
                </div>
                <div class="win-body">
                    <div id="local-grid"></div>
                </div>
            </div>

        </div>

        <div class="dock-container">
            <div class="dock">
                <button class="dock-btn active" onclick="switchTab('terminal')">TERMINAL</button>
                <button class="dock-btn" onclick="switchTab('identity')">IDENTITY</button>
                <button class="dock-btn" onclick="switchTab('resources')">RESOURCES</button>
                <button class="dock-btn" onclick="switchTab('local')">HOST</button>
                <button class="dock-btn" onclick="toggleLight()">LIGHT</button>
            </div>
        </div>

    </div>

    <script>
        let mx = window.innerWidth/2, my = window.innerHeight/2;
        let lightOn = true;

        document.addEventListener('mousemove', e => {
            mx = e.clientX; my = e.clientY;
            updateLight();
        });

        document.addEventListener('touchmove', e => {
            if(e.touches.length > 0) {
                mx = e.touches[0].clientX;
                my = e.touches[0].clientY;
                updateLight();
            }
        }, {passive: true});

        function updateLight() {
            if(lightOn) {
                document.getElementById('light-mask').style.background =
                    `radial-gradient(circle 600px at ${mx}px ${my}px, transparent 0%, rgba(2, 2, 2, 0.85) 50%,
                    rgba(2, 2, 2, 1) 100%)`;
            }
        }

        function toggleLight() {
            lightOn = !lightOn;
            document.getElementById('light-mask').style.background = lightOn
                ? `radial-gradient(circle 600px at ${mx}px ${my}px, transparent 0%, rgba(2,2,2,0.95) 70%)`
                : 'rgba(0,0,0,0.3)';
        }

        function switchTab(id) {
            document.querySelectorAll('.window').forEach(w => w.classList.remove('active'));
            document.getElementById(`win-${id}`).classList.add('active');

            document.querySelectorAll('.dock-btn').forEach(b => b.classList.remove('active'));
            const btn = Array.from(document.querySelectorAll('.dock-btn')).find(b => b.innerText.toLowerCase().includes(id));
            if(btn) btn.classList.add('active');

            if(id === 'terminal' && window.innerWidth > 768) {
                setTimeout(() => document.querySelector('.inp')?.focus(), 10);
            }
            if(id === 'local') runRecon();
        }

        function filterRes(cat) {
            document.querySelectorAll('.res-nav button').forEach(b => b.classList.remove('active'));
            Array.from(document.querySelectorAll('.res-nav button')).find(b => b.innerText.toLowerCase().includes(cat)).classList.add('active');

            document.querySelectorAll('.res-section').forEach(s => {
                if(cat === 'all') s.classList.add('active');
                else {
                    if(s.id === `cat-${cat}`) s.classList.add('active');
                    else s.classList.remove('active');
                }
            });
        }

        function updateSys() {
            const el = document.getElementById('sys-data');
            if(!el) return;
            el.innerHTML = `
                <div class="stat-row"><span class="stat-label">OS</span><span class="stat-val">${navigator.platform.toUpperCase()}</span></div>
                <div class="stat-row"><span class="stat-label">CORES</span><span class="stat-val">${navigator.hardwareConcurrency || 4}</span></div>
                <div class="stat-row"><span class="stat-label">RES</span><span class="stat-val">${window.screen.width}x${window.screen.height}</span></div>
                <div class="stat-row"><span class="stat-label">TIME</span><span class="stat-val" style="color:var(--c-accent)">${new Date().toLocaleTimeString()}</span></div>
            `;
        }
        setInterval(updateSys, 1000);
        updateSys();

        const term = document.getElementById('term-output');
        function termInput() {
            const d = document.createElement('div');
            d.className = 'ln';
            d.innerHTML = `<span class="pr">torch@sys:~ $</span><input class="inp" spellcheck="false" autofocus>`;
            term.appendChild(d);
            const i = d.querySelector('input');
            i.focus();
            i.onkeydown = e => {
                if(e.key === 'Enter') {
                    const v = i.value.trim();
                    i.disabled = true;
                    if(v) runCmd(v);
                    termInput();
                }
            };
            term.scrollTop = term.scrollHeight;
        }

        function runCmd(cmd) {
            const args = cmd.split(' ');
            const c = args[0].toLowerCase();
            if(c === 'help') log('COMMANDS: help, clear, resources, whoami');
            else if(c === 'clear') term.innerHTML = '';
            else if(c === 'resources') switchTab('resources');
            else if(c === 'whoami') log('User: TORCH // Team: JordanSec');
            else log(`bash: ${c}: command not found`, '#f55');
        }

        function log(t, color='#ccc') {
            const d = document.createElement('div');
            d.className = 'ln'; d.style.color = color; d.innerText = t;
            term.appendChild(d);
        }
        termInput();

        function runRecon() {
            const div = document.getElementById('local-grid');
            div.innerHTML = '';
            const stats = [
                { l:'OS', v:navigator.platform },
                { l:'CORES', v:navigator.hardwareConcurrency || 'N/A' },
                { l:'MEMORY', v:navigator.deviceMemory ? `~${navigator.deviceMemory}GB` : 'Protected' },
                { l:'RES', v:`${window.screen.width}x${window.screen.height}` },
                { l:'BROWSER', v:navigator.userAgent.split(' ').pop().split('/')[0] },
                { l:'ONLINE', v:navigator.onLine ? 'YES' : 'NO' }
            ];
            stats.forEach(s => {
                div.innerHTML += `
                <div class="data-card">
                    <h3 style="color:var(--c-accent); font-size:0.7rem; font-weight:bold; margin-bottom:5px;">${s.l}</h3>
                    <div class="data-val">${s.v}</div>
                </div>`;
            });
        }

        const canvas = document.getElementById('particle-canvas');
        const ctx = canvas.getContext('2d');
        let width, height, particles = [];

        function resize() {
            const dpr = window.devicePixelRatio || 1;
            canvas.width = window.innerWidth * dpr;
            canvas.height = window.innerHeight * dpr;
            canvas.style.width = `${window.innerWidth}px`;
            canvas.style.height = `${window.innerHeight}px`;
            ctx.scale(dpr, dpr);
            width = window.innerWidth;
            height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        for(let i=0; i<300; i++) {
            particles.push({
                x: Math.random()*width,
                y: Math.random()*height,
                vx: (Math.random() - 0.5) * 1,
                vy: (Math.random() - 0.5) * 1,
                s: 1 + Math.random() * 2
            });
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);

            for(let i = 0; i < particles.length; i++) {
                let p = particles[i];

                p.x += p.vx;
                p.y += p.vy;

                if(p.x < 0 || p.x > width) p.vx *= -1;
                if(p.y < 0 || p.y > height) p.vy *= -1;

                const dx_m = p.x - mx;
                const dy_m = p.y - my;
                const dist_m = Math.sqrt(dx_m*dx_m + dy_m*dy_m);

                for(let j = i + 1; j < particles.length; j++) {
                    let p2 = particles[j];
                    let dx = p.x - p2.x;
                    let dy = p.y - p2.y;
                    let dist = Math.sqrt(dx*dx + dy*dy);

                    if(dist < 100) {
                        ctx.beginPath();
                        ctx.strokeStyle = '#ff9d00';

                        let alpha = (1 - dist/100) * 0.5;

                        if(dist_m < 350) {
                            alpha += (1 - dist_m/350) * 0.8;
                        } else {
                            alpha *= 0.15;
                        }

                        if(alpha > 1) alpha = 1;
                        if(alpha < 0) alpha = 0;

                        if(alpha > 0.01) {
                            ctx.globalAlpha = alpha;
                            ctx.lineWidth = 1;
                            ctx.moveTo(p.x, p.y);
                            ctx.lineTo(p2.x, p2.y);
                            ctx.stroke();
                        }
                    }
                }

                ctx.fillStyle = '#ff9d00';
                let pAlpha = 0.2;
                if(dist_m < 350) pAlpha += (1 - dist_m/350);
                if(pAlpha > 1) pAlpha = 1;

                ctx.globalAlpha = pAlpha;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.s, 0, Math.PI * 2);
                ctx.fill();
            }
            requestAnimationFrame(animate);
        }
        animate();

    </script>
</body>
</html>
